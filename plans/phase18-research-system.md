# é˜¶æ®µ18: ç§‘æŠ€ç ”å‘ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## æ¦‚è¿°

å®ç°LLMé©±åŠ¨çš„æ¶Œç°å¼ç§‘æŠ€å‘æ˜ç³»ç»Ÿã€‚ç©å®¶é€šè¿‡è‡ªç„¶è¯­è¨€æè¿°æƒ³è¦å‘æ˜çš„æŠ€æœ¯ï¼ŒLLMè¯„ä¼°å¯è¡Œæ€§å¹¶ç”Ÿæˆå®Œæ•´çš„æŠ€æœ¯å¡ç‰‡ï¼ŒåŒ…æ‹¬æ–°ç”Ÿäº§æ–¹å¼ã€å‰¯ä½œç”¨å’Œä¸“åˆ©ä¿¡æ¯ã€‚

## æ ¸å¿ƒè®¾è®¡ç†å¿µ

æ ¹æ®GDDç¬¬ä¸ƒç« ï¼Œæœ¬ç³»ç»Ÿçš„ç‹¬ç‰¹ä¹‹å¤„ï¼š
- **æ²¡æœ‰é¢„è®¾ç§‘æŠ€æ ‘** - ç§‘æŠ€ç”±ç©å®¶æè¿°åˆ›é€ 
- **LLMæ‹…ä»»é¦–å¸­ç§‘å­¦å®¶** - è¯„ä¼°å¯è¡Œæ€§ã€ç”ŸæˆæŠ€æœ¯è§„æ ¼
- **ç¯ç¥è¯…å’’** - æŠ€æœ¯å¯èƒ½å¸¦æœ‰æ„å¤–çš„å‰¯ä½œç”¨
- **Promptæªè¾é‡è¦** - ç²¾ç¡®æè¿°å¯é™ä½å‰¯ä½œç”¨é£é™©

## ç³»ç»Ÿæ¶æ„

```mermaid
flowchart TB
    subgraph Client[å®¢æˆ·ç«¯]
        RL[ResearchLabç»„ä»¶]
        RL -->|æäº¤æ¦‚å¿µ| API[APIè°ƒç”¨]
        RL -->|æ˜¾ç¤º| TC[TechCardæŠ€æœ¯å¡ç‰‡]
        RL -->|æ˜¾ç¤º| SC[æ˜Ÿå›¾Constellation]
    end
    
    subgraph Server[æœåŠ¡ç«¯]
        RR[researchRoutes]
        RR -->|è°ƒç”¨| RS[ResearchService]
        RS -->|è¯„ä¼°| LLM[LLMæœåŠ¡]
        RS -->|å­˜å‚¨| DB[(æ•°æ®åº“)]
        RS -->|åº”ç”¨| GS[GameState]
        
        LLM -->|å¯è¡Œæ€§| FE[FeasibilityCheck]
        LLM -->|ç”Ÿæˆ| TG[TechGeneration]
    end
    
    API --> RR
    GS -->|æ–°ç”Ÿäº§æ–¹å¼| PC[ProductionCalculator]
```

## æ•°æ®ç»“æ„

### Technology ç±»å‹
```typescript
interface Technology {
  id: EntityId;
  name: string;
  description: string;
  inventorId: EntityId;  // å‘æ˜è€…å…¬å¸ID
  inventedAt: GameTick;
  
  // åˆ†ç±»
  category: TechCategory;  // energy | materials | automation | biotech | computing
  
  // æ•ˆæœ
  unlockedProductionMethods: ProductionMethodUnlock[];
  unlockedProducts: ProductId[];
  modifiers: TechModifier[];
  
  // å‰¯ä½œç”¨
  sideEffects: SideEffect[];
  
  // ä¸“åˆ©
  patent: {
    holder: EntityId;
    expiresAt: GameTick;
    licensees: EntityId[];
    licenseFee: number;  // æ¯æ¬¡ä½¿ç”¨çš„è´¹ç”¨
  };
  
  // å‰ç½®æ¡ä»¶
  prerequisites: EntityId[];
  
  // LLMç”Ÿæˆçš„å…ƒæ•°æ®
  llmMetadata: {
    originalPrompt: string;
    feasibilityScore: number;
    riskLevel: RiskLevel;
    generatedAt: string;
  };
}

interface SideEffect {
  type: 'health' | 'environment' | 'social' | 'economic';
  description: string;
  severity: 1 | 2 | 3 | 4 | 5;
  triggerCondition: string;  // è§¦å‘æ¡ä»¶æè¿°
  delay: GameTick;  // å»¶è¿Ÿå¤šå°‘tickåç”Ÿæ•ˆ
  revealed: boolean;  // æ˜¯å¦å·²æ˜¾ç°
}

interface ProductionMethodUnlock {
  buildingType: string;
  slotName: string;
  newOption: ProductionMethod;
}

type RiskLevel = 'minimal' | 'low' | 'moderate' | 'high' | 'extreme';
type TechCategory = 'energy' | 'materials' | 'automation' | 'biotech' | 'computing' | 'other';
```

### ResearchProject ç ”å‘é¡¹ç›®
```typescript
interface ResearchProject {
  id: EntityId;
  companyId: EntityId;
  
  // æ¦‚å¿µæè¿°
  concept: {
    name: string;
    description: string;  // ç©å®¶è¾“å…¥çš„æè¿°
    targetOutcome: string;
  };
  
  // è¯„ä¼°ç»“æœ
  feasibility: {
    score: number;  // 0-100
    estimatedCost: number;
    estimatedDuration: GameTick;
    prerequisites: string[];
    risks: string[];
  };
  
  // è¿›åº¦
  status: 'concept' | 'evaluating' | 'approved' | 'researching' | 'completed' | 'failed' | 'cancelled';
  progress: number;  // 0-100
  investedFunds: number;
  startedAt?: GameTick;
  completedAt?: GameTick;
  
  // å®Œæˆåçš„æŠ€æœ¯
  resultTechnology?: Technology;
}
```

## å®ç°è®¡åˆ’

### 18.1 åŸºç¡€æ•°æ®ç»“æ„ä¸ç±»å‹å®šä¹‰

**ç›®æ ‡**: å®šä¹‰æ‰€æœ‰ç ”å‘ç³»ç»Ÿç›¸å…³çš„TypeScriptç±»å‹

**ä»»åŠ¡**:
1. åœ¨ `packages/shared/src/types/technology.ts` æ‰©å±•Technologyæ¥å£
2. æ·»åŠ  ResearchProject æ¥å£
3. æ·»åŠ  SideEffectã€ProductionMethodUnlock ç­‰è¾…åŠ©ç±»å‹
4. åœ¨ game-state.ts ä¸­æ·»åŠ ç ”å‘ç›¸å…³çŠ¶æ€å­—æ®µ

### 18.2 åç«¯ç ”å‘æœåŠ¡

**ç›®æ ‡**: åˆ›å»ºå¤„ç†ç ”å‘é€»è¾‘çš„åç«¯æœåŠ¡

**ä»»åŠ¡**:
1. åˆ›å»º `packages/server/src/services/researchService.ts`
2. å®ç° `evaluateConcept()` - è°ƒç”¨LLMè¯„ä¼°å¯è¡Œæ€§
3. å®ç° `startResearch()` - å¯åŠ¨ç ”å‘é¡¹ç›®
4. å®ç° `progressResearch()` - åœ¨gameLoopä¸­æ¨è¿›ç ”å‘è¿›åº¦
5. å®ç° `completeResearch()` - å®Œæˆç ”å‘ï¼Œç”ŸæˆæŠ€æœ¯å¡ç‰‡
6. å®ç° `applyTechnology()` - å°†æ–°æŠ€æœ¯åº”ç”¨åˆ°æ¸¸æˆçŠ¶æ€

### 18.3 LLMç§‘æŠ€è¯„ä¼°ä¸ç”Ÿæˆ

**ç›®æ ‡**: å®ç°LLMé©±åŠ¨çš„ç§‘æŠ€è¯„ä¼°å’Œç”Ÿæˆ

**ä»»åŠ¡**:
1. åœ¨ `llm.ts` æ·»åŠ  `evaluateResearchConcept()` æ–¹æ³•
2. åœ¨ `llm.ts` æ·»åŠ  `generateTechnology()` æ–¹æ³•
3. è®¾è®¡è¯„ä¼°Promptæ¨¡æ¿ï¼ˆé¦–å¸­ç§‘å­¦å®¶è§’è‰²ï¼‰
4. è®¾è®¡æŠ€æœ¯ç”ŸæˆPromptæ¨¡æ¿ï¼ˆåŒ…å«å‰¯ä½œç”¨ç”Ÿæˆï¼‰
5. å®ç°JSON SchemaéªŒè¯ç¡®ä¿è¾“å‡ºæ ¼å¼æ­£ç¡®
6. å¤„ç†æªè¾æ¨¡ç³Šå¯¼è‡´çš„å‰¯ä½œç”¨å¢åŠ é€»è¾‘

### 18.4 ç ”å‘APIè·¯ç”±

**ç›®æ ‡**: åˆ›å»ºç ”å‘ç›¸å…³çš„HTTPç«¯ç‚¹

**ä»»åŠ¡**:
1. åˆ›å»º `packages/server/src/routes/research.ts`
2. POST `/api/research/evaluate` - è¯„ä¼°ç ”å‘æ¦‚å¿µ
3. POST `/api/research/start` - å¯åŠ¨ç ”å‘é¡¹ç›®
4. GET `/api/research/projects` - è·å–å½“å‰ç ”å‘é¡¹ç›®åˆ—è¡¨
5. POST `/api/research/cancel/:id` - å–æ¶ˆç ”å‘é¡¹ç›®
6. GET `/api/research/technologies` - è·å–å·²å‘æ˜æŠ€æœ¯åˆ—è¡¨
7. åœ¨routes/index.tsä¸­æ³¨å†Œæ–°è·¯ç”±

### 18.5 GameLoopé›†æˆ

**ç›®æ ‡**: å°†ç ”å‘è¿›åº¦æ¨è¿›é›†æˆåˆ°æ¸¸æˆå¾ªç¯

**ä»»åŠ¡**:
1. åœ¨gameLoop.tsçš„processTickä¸­æ·»åŠ ç ”å‘è¿›åº¦æ›´æ–°
2. æ¯tickæ ¹æ®æŠ•å…¥èµ„é‡‘æ¨è¿›ç ”å‘è¿›åº¦
3. æ£€æµ‹ç ”å‘å®Œæˆå¹¶è§¦å‘æŠ€æœ¯ç”Ÿæˆ
4. å¤„ç†å‰¯ä½œç”¨çš„å»¶è¿Ÿè§¦å‘
5. é€šè¿‡WebSocketæ¨é€ç ”å‘è¿›åº¦æ›´æ–°

### 18.6 å‰ç«¯ç ”å‘å®éªŒå®¤ç»„ä»¶

**ç›®æ ‡**: åˆ›å»ºç ”å‘ç•Œé¢UI

**ä»»åŠ¡**:
1. åˆ›å»º `packages/client/src/components/game/ResearchLab.tsx`
2. å®ç°æ¦‚å¿µè¾“å…¥è¡¨å•ï¼ˆé¡¹ç›®åç§°ã€æè¿°æ–‡æœ¬æ¡†ï¼‰
3. å®ç°å®æ—¶å…³é”®è¯æå–å’Œé£é™©é¢„è§ˆ
4. å®ç°å¯è¡Œæ€§è¯„ä¼°ç»“æœæ˜¾ç¤º
5. å®ç°ç ”å‘è¿›åº¦æ¡å’ŒçŠ¶æ€æ˜¾ç¤º
6. æ·»åŠ åˆ°App.tsxçš„researché¢æ¿

### 18.7 æŠ€æœ¯å¡ç‰‡ç»„ä»¶

**ç›®æ ‡**: å±•ç¤ºå·²å‘æ˜çš„æŠ€æœ¯è¯¦æƒ…

**ä»»åŠ¡**:
1. åˆ›å»º `packages/client/src/components/game/TechCard.tsx`
2. è®¾è®¡è“å›¾é£æ ¼çš„æŠ€æœ¯å¡ç‰‡UI
3. æ˜¾ç¤ºæŠ€æœ¯æ•ˆæœï¼ˆè§£é”çš„ç”Ÿäº§æ–¹å¼ï¼‰
4. æ˜¾ç¤ºå‰¯ä½œç”¨è­¦å‘Šï¼ˆç”¨çº¢è‰²å°å­—ï¼‰
5. æ˜¾ç¤ºä¸“åˆ©ä¿¡æ¯å’Œæˆæƒé€‰é¡¹

### 18.8 ä¸“åˆ©ç³»ç»Ÿ

**ç›®æ ‡**: å®ç°æŠ€æœ¯ä¸“åˆ©å’Œæˆæƒæœºåˆ¶

**ä»»åŠ¡**:
1. åœ¨Technologyç±»å‹ä¸­å®Œå–„ä¸“åˆ©å­—æ®µ
2. å®ç°ä¸“åˆ©ç‹¬å æœŸé€»è¾‘ï¼ˆ5å¹´å†…åªæœ‰å‘æ˜è€…å¯ç”¨ï¼‰
3. å®ç°ä¸“åˆ©æˆæƒAPI - å…è®¸å…¶ä»–å…¬å¸ä»˜è´¹ä½¿ç”¨
4. å®ç°ä¸“åˆ©å‡ºå”®API
5. AIå…¬å¸å¯ä»¥è¯·æ±‚ä¸“åˆ©æˆæƒ

### 18.9 å‰¯ä½œç”¨ç³»ç»Ÿ

**ç›®æ ‡**: å®ç°æŠ€æœ¯çš„å‰¯ä½œç”¨è§¦å‘æœºåˆ¶

**ä»»åŠ¡**:
1. è®¾è®¡å‰¯ä½œç”¨è§¦å‘æ¡ä»¶æ£€æµ‹
2. åœ¨gameLoopä¸­æ£€æµ‹å‰¯ä½œç”¨è§¦å‘
3. å‰¯ä½œç”¨è§¦å‘æ—¶ç”Ÿæˆå¸‚åœºäº‹ä»¶
4. å‰¯ä½œç”¨å¯èƒ½å¯¼è‡´é›†ä½“è¯‰è®¼ã€ç½šæ¬¾ç­‰
5. åœ¨NeuralFeedä¸­æ˜¾ç¤ºå‰¯ä½œç”¨è­¦å‘Š

### 18.10 Storeä¸çŠ¶æ€ç®¡ç†

**ç›®æ ‡**: å‰ç«¯çŠ¶æ€ç®¡ç†æ›´æ–°

**ä»»åŠ¡**:
1. åœ¨gameStoreä¸­æ·»åŠ technologiesæ•°ç»„
2. åœ¨gameStoreä¸­æ·»åŠ researchProjectsæ•°ç»„
3. æ·»åŠ ç›¸å…³actionsï¼ˆstartResearch, cancelResearchç­‰ï¼‰
4. WebSocketå¤„ç†ç ”å‘ç›¸å…³æ¶ˆæ¯
5. æ·»åŠ ä¾¿æ·çš„selector hooks

### 18.11 ç§‘æŠ€æ˜Ÿå›¾ï¼ˆå¯é€‰è¿›é˜¶ï¼‰

**ç›®æ ‡**: å¯è§†åŒ–å±•ç¤ºæŠ€æœ¯å…³è”

**ä»»åŠ¡**:
1. åˆ›å»º `TechConstellation.tsx` ç»„ä»¶
2. ä½¿ç”¨D3.jsæˆ–ç±»ä¼¼åº“æ¸²æŸ“æ˜Ÿå›¾
3. å·²å‘æ˜æŠ€æœ¯æ˜¾ç¤ºä¸ºäº®æ˜Ÿ
4. æœªå‘æ˜ä½†å¯æ¨æ–­çš„æŠ€æœ¯æ˜¾ç¤ºä¸ºæš—æ˜Ÿ
5. æ˜¾ç¤ºæŠ€æœ¯ä¹‹é—´çš„å…³è”çº¿

## UIè®¾è®¡

### ç ”å‘å®éªŒå®¤ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”¬ ç ”å‘å®éªŒå®¤                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  é¡¹ç›®åç§°: [________________________]                        â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  æè¿°ä½ æƒ³å‘æ˜çš„æŠ€æœ¯...                               â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â”‚  ä¾‹å¦‚ï¼šæˆ‘æƒ³ç ”å‘ä¸€ç§åŸºäºæµ·è—»çš„ç”Ÿç‰©ç‡ƒæ–™ï¼Œç”¨æ¥æ›¿ä»£      â”‚    â”‚
â”‚  â”‚  çŸ³æ²¹ï¼Œæˆæœ¬å¿…é¡»æ¯”çŸ³æ²¹ä½ï¼Œä½†å¯ä»¥æ¥å—æ•ˆç‡ç¨ä½ã€‚        â”‚    â”‚
â”‚  â”‚                                                      â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  å®æ—¶åˆ†æ:                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚ æ£€æµ‹åˆ°å…³é”®è¯:       â”‚ â”‚ é£é™©è¯„ä¼°:          â”‚             â”‚
â”‚  â”‚ â€¢ æµ·è—»ï¼ˆç”Ÿç‰©è´¨ï¼‰    â”‚ â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ ä¸­ç­‰   â”‚             â”‚
â”‚  â”‚ â€¢ çŸ³æ²¹æ›¿ä»£         â”‚ â”‚                    â”‚             â”‚
â”‚  â”‚ â€¢ æˆæœ¬æ•æ„Ÿ         â”‚ â”‚ é¢„ä¼°æˆæœ¬:          â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Â¥5000ä¸‡ - Â¥8000ä¸‡  â”‚             â”‚
â”‚                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                                              â”‚
â”‚  [å–æ¶ˆ] [æäº¤è¯„ä¼°]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯å¡ç‰‡
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                   ã€è“è—»ç”Ÿç‰©ç‡ƒæ²¹å·¥è‰ºã€‘                        â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚                                                              â”‚
â”‚  ç±»å‹: èƒ½æº / ç”Ÿäº§å·¥è‰º                                       â”‚
â”‚  å‘æ˜è€…: [ç©å®¶å…¬å¸å]                                        â”‚
â”‚  ä¸“åˆ©æœ‰æ•ˆæœŸ: å‰©ä½™ 4 å¹´ 3 ä¸ªæœˆ                                â”‚
â”‚                                                              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  è§£é”ç”Ÿäº§æ–¹å¼:                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ã€å‘ç”µå‚ã€‘æ–°å¢é€‰é¡¹: ç”Ÿç‰©ç‡ƒæ²¹å‘ç”µ                        â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å…¥: æµ·è—» Ã—10, æ°´ Ã—5                              â”‚  â”‚
â”‚  â”‚  â€¢ è¾“å‡º: ç”µåŠ› Ã—7                                       â”‚  â”‚
â”‚  â”‚  â€¢ å‰¯äº§ç‰©: æœ‰æœºæ±¡æ³¥ Ã—2                                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  âš  å‰¯ä½œç”¨è­¦å‘Š:                                               â”‚
â”‚  â€¢ æœ‰æœºæ±¡æ³¥å¦‚ä¸å¦¥å–„å¤„ç†å¯èƒ½é€ æˆæ°´ä½“æ±¡æŸ“                      â”‚
â”‚  â€¢ è—»ç±»åŸ¹å…»éœ€è¦å¤§é‡æ·¡æ°´èµ„æº                                  â”‚
â”‚                                                              â”‚
â”‚  [æˆæƒç»™ä»–äºº] [ç‹¬å ä½¿ç”¨]                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## LLM Promptæ¨¡æ¿

### å¯è¡Œæ€§è¯„ä¼°Prompt
```
ä½ æ˜¯ä¸€å®¶ç§‘æŠ€å…¬å¸çš„é¦–å¸­ç§‘å­¦å®¶ï¼Œæ­£åœ¨è¯„ä¼°ä¸€ä¸ªç ”å‘æ¦‚å¿µçš„å¯è¡Œæ€§ã€‚

## ç©å®¶çš„ç ”å‘æ¦‚å¿µ
é¡¹ç›®åç§°: {projectName}
æè¿°: {description}

## å½“å‰æ¸¸æˆä¸–ç•Œçš„æŠ€æœ¯æ°´å¹³
å·²æœ‰æŠ€æœ¯: {existingTechnologies}
å½“å‰å¹´ä»½: {gameYear}

## è¯„ä¼°ä»»åŠ¡
è¯·åˆ†æè¿™ä¸ªæ¦‚å¿µçš„å¯è¡Œæ€§ï¼Œå¹¶è¿”å›JSONæ ¼å¼çš„è¯„ä¼°ç»“æœï¼š

{
  "feasibilityScore": 0-100çš„æ•´æ•°,
  "estimatedCost": é¢„ä¼°æˆæœ¬ï¼ˆç¾å…ƒï¼‰,
  "estimatedMonths": é¢„ä¼°ç ”å‘å‘¨æœŸï¼ˆæœˆï¼‰,
  "prerequisites": ["å‰ç½®æŠ€æœ¯1", "å‰ç½®æŠ€æœ¯2"],
  "risks": ["æ½œåœ¨é£é™©1", "æ½œåœ¨é£é™©2"],
  "scientistComment": "ç§‘å­¦å®¶çš„è¯„è¯­ï¼ˆ50-100å­—ï¼‰",
  "keywordAnalysis": ["æå–çš„å…³é”®æŠ€æœ¯è¯æ±‡"]
}

## è¯„ä¼°è§„åˆ™
1. è¶Šæ¨¡ç³Šçš„æè¿°ï¼Œé£é™©è¶Šé«˜
2. ä¸ç°æœ‰æŠ€æœ¯ç›¸å·®è¶Šè¿œï¼Œæˆæœ¬è¶Šé«˜
3. æ¶‰åŠç”Ÿç‰©/åŒ–å­¦/æ ¸èƒ½çš„é¡¹ç›®éœ€è¦æ›´é•¿å‘¨æœŸ
4. å¦‚æœæè¿°ä¸­æ˜ç¡®æ’é™¤äº†æŸäº›é—®é¢˜ï¼Œé£é™©ç›¸åº”é™ä½
```

### æŠ€æœ¯ç”ŸæˆPrompt
```
ä½ æ˜¯ä¸€ä¸ªç§‘æŠ€å…¬å¸çš„ç ”å‘éƒ¨é—¨ï¼Œåˆšåˆšå®Œæˆäº†ä¸€é¡¹æŠ€æœ¯å‘æ˜ã€‚è¯·ç”Ÿæˆå®Œæ•´çš„æŠ€æœ¯è§„æ ¼ã€‚

## åŸå§‹ç ”å‘æ¦‚å¿µ
{originalConcept}

## ç ”å‘è¿‡ç¨‹
æŠ•å…¥èµ„é‡‘: {investedFunds}
ç ”å‘å‘¨æœŸ: {duration}

## ç”Ÿæˆè¦æ±‚
è¯·è¿”å›JSONæ ¼å¼çš„å®Œæ•´æŠ€æœ¯è§„æ ¼ï¼š

{
  "name": "æŠ€æœ¯åç§°ï¼ˆä¸­æ–‡ï¼‰",
  "description": "æŠ€æœ¯æè¿°ï¼ˆ100-200å­—ï¼‰",
  "category": "energy|materials|automation|biotech|computing|other",
  
  "productionMethods": [
    {
      "buildingType": "é€‚ç”¨çš„å»ºç­‘ç±»å‹ID",
      "slotName": "é€‚ç”¨çš„æ§½ä½å",
      "optionName": "æ–°é€‰é¡¹åç§°",
      "inputs": {"èµ„æºID": æ•°é‡},
      "outputs": {"èµ„æºID": æ•°é‡},
      "modifiers": {"throughput": 1.0, "quality": 1.0}
    }
  ],
  
  "sideEffects": [
    {
      "type": "health|environment|social|economic",
      "description": "å‰¯ä½œç”¨æè¿°",
      "severity": 1-5,
      "triggerCondition": "è§¦å‘æ¡ä»¶æè¿°",
      "delayMonths": å»¶è¿Ÿæœˆæ•°
    }
  ],
  
  "marketTags": ["æ ‡ç­¾1", "æ ‡ç­¾2"]
}

## å‰¯ä½œç”¨ç”Ÿæˆè§„åˆ™
1. åŸå§‹æè¿°è¶Šæ¨¡ç³Šï¼Œå‰¯ä½œç”¨è¶Šå¤šã€è¶Šä¸¥é‡
2. æ¶‰åŠç”Ÿç‰©/åŒ–å­¦çš„æŠ€æœ¯æœ‰å¥åº·é£é™©
3. æ¶‰åŠèƒ½æºçš„æŠ€æœ¯æœ‰ç¯å¢ƒé£é™©
4. æ¶‰åŠè‡ªåŠ¨åŒ–çš„æŠ€æœ¯æœ‰ç¤¾ä¼šé£é™©ï¼ˆå¤±ä¸šï¼‰
5. è‡³å°‘ç”Ÿæˆ1ä¸ªå‰¯ä½œç”¨ï¼Œæœ€å¤š3ä¸ª
```

## æ–‡ä»¶ä¿®æ”¹æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹å†…å®¹ |
|------|----------|
| `packages/shared/src/types/technology.ts` | æ‰©å±•Technologyç±»å‹ï¼Œæ·»åŠ ResearchProject |
| `packages/shared/src/types/game-state.ts` | æ·»åŠ technologieså’ŒresearchProjectså­—æ®µ |
| `packages/server/src/services/researchService.ts` | æ–°å»º - ç ”å‘é€»è¾‘æœåŠ¡ |
| `packages/server/src/services/llm.ts` | æ·»åŠ evaluateResearchConceptå’ŒgenerateTechnologyæ–¹æ³• |
| `packages/server/src/routes/research.ts` | æ–°å»º - ç ”å‘APIè·¯ç”± |
| `packages/server/src/routes/index.ts` | æ³¨å†Œç ”å‘è·¯ç”± |
| `packages/server/src/services/gameLoop.ts` | é›†æˆç ”å‘è¿›åº¦æ¨è¿› |
| `packages/client/src/components/game/ResearchLab.tsx` | æ–°å»º - ç ”å‘å®éªŒå®¤UI |
| `packages/client/src/components/game/TechCard.tsx` | æ–°å»º - æŠ€æœ¯å¡ç‰‡UI |
| `packages/client/src/components/game/index.ts` | å¯¼å‡ºæ–°ç»„ä»¶ |
| `packages/client/src/stores/gameStore.ts` | æ·»åŠ ç ”å‘ç›¸å…³çŠ¶æ€å’Œactions |
| `packages/client/src/App.tsx` | é›†æˆResearchLabåˆ°researché¢æ¿ |

## éªŒæ”¶æ ‡å‡†

1. âœ… ç©å®¶å¯ä»¥åœ¨ç ”å‘å®éªŒå®¤è¾“å…¥è‡ªç„¶è¯­è¨€æè¿°æŠ€æœ¯æ¦‚å¿µ
2. âœ… LLMè¿”å›å¯è¡Œæ€§è¯„ä¼°ç»“æœï¼ˆæˆæœ¬ã€å‘¨æœŸã€é£é™©ï¼‰
3. âœ… ç©å®¶å¯ä»¥å¯åŠ¨ç ”å‘é¡¹ç›®å¹¶æŠ•å…¥èµ„é‡‘
4. âœ… ç ”å‘è¿›åº¦éšæ—¶é—´æ¨è¿›
5. âœ… ç ”å‘å®Œæˆåç”ŸæˆæŠ€æœ¯å¡ç‰‡ï¼Œæ˜¾ç¤ºæ–°ç”Ÿäº§æ–¹å¼
6. âœ… æŠ€æœ¯å¯èƒ½å¸¦æœ‰å‰¯ä½œç”¨ï¼Œåœ¨ä¸€å®šå»¶è¿Ÿåè§¦å‘
7. âœ… æ–°æŠ€æœ¯è§£é”çš„ç”Ÿäº§æ–¹å¼å¯åœ¨å·¥å‚ä¸­é€‰æ‹©
8. âœ… ä¸“åˆ©ç³»ç»Ÿï¼š5å¹´å†…ç‹¬å æˆ–å¯æˆæƒ

## åç»­æ‰©å±•

- 18.11 ç§‘æŠ€æ˜Ÿå›¾å¯è§†åŒ–
- AIå…¬å¸ä¹Ÿå¯ä»¥ç ”å‘æŠ€æœ¯
- æŠ€æœ¯è·¯çº¿ç«äº‰ï¼ˆå¤šä¸ªæŠ€æœ¯ç«äº‰å¸‚åœºæ ‡å‡†ï¼‰
- æŠ€æœ¯ç»„åˆï¼ˆå¤šä¸ªæŠ€æœ¯ç»„åˆäº§ç”Ÿæ–°æ•ˆæœï¼‰